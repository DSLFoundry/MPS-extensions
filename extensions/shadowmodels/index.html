<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Extensions and utilities for MPS">
    
    <link rel="canonical" href="https://jetbrains.github.io/MPS-extensions/extensions/shadowmodels/">
    <link rel="../../img/favicon.ico">

    
    <title>Shadow Models - MPS Extension</title>
    

    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">
    <link href="../../css/highlight.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    <script src="//ajax.googleapis.com/ajax/libs/webfont/1.6.28/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../..">MPS Extension</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../building/">Building</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../contributing/">Contributing</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../Migrating/">Migrating</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Extensions <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../diagrams/">Diagrams</a>
</li>

                        
                            
<li >
    <a href="../node-versioning/">Node Versioning</a>
</li>

                        
                            
<li class="active">
    <a href="./">Shadow Models</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../node-versioning/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/jetbrains/mps-extensions/edit/master/docs/extensions/shadowmodels.md"><i class="fab fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#shadow-models">Shadow Models</a></li>
        <li class="first-level "><a href="#download">Download</a></li>
        <li class="first-level "><a href="#examples">Examples</a></li>
        <li class="first-level "><a href="#transformation-language">Transformation Language</a></li>
            <li class="second-level"><a href="#cross-model-generation">Cross Model Generation?</a></li>
                
            <li class="second-level"><a href="#multiple-target-languages-fork">Multiple Target Languages (fork)?</a></li>
                
            <li class="second-level"><a href="#references-to-non-shadow-nodes">References to Non-Shadow Nodes</a></li>
                
        <li class="first-level "><a href="#traceback">Traceback</a></li>
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="shadow-models">Shadow Models</h1>
<p>A shadow model is a non-editable model derived from existing models by model-to-model transformations.
It is incrementally maintained while editing the input model.</p>
<p>Transformations are described in a special language designed to support incremental updates of the output model.
Dynamic dependency tracking is used during the executing of the transformations which removes the need for a declarative language.
BaseLanguage expressions with all its extensions are supported inside the transformation rules.</p>
<p>While the primary use cases of shadow models are not code generation, they come with a transformation language that solves some other issues of the MPS generator in a more elegant way (cross model generation, multiple target languages, extensibility).</p>
<h1 id="download">Download</h1>
<p>Download the nighty build of the plugins from the <a href="https://github.com/JetBrains/MPS-extensions/releases">release page</a>.</p>
<h1 id="examples">Examples</h1>
<p>There is a separate <strong>Shadow Models (Examples)</strong> plugin that contains some example languages and transformation implementations to show you how to build your own shadow models.
The languages and input models can be found in the namespace <strong>de.q60.mps.shadowmodels.examples</strong>. The transformations are implemented in the <em>transformation</em> aspect.</p>
<h1 id="transformation-language">Transformation Language</h1>
<p>The transformation language is similar to the MPS generator language. It has transformation rules with a left side that describes the input it applies to and a right side that builds the output.</p>
<p>The right side is similar to <a href="https://confluence.jetbrains.com/display/MPSD20183/Quotations#Quotations-Lightquotations%28quotationbuilders%29">light quotations</a> instead of using the concrete syntax of the target language.</p>
<h2 id="cross-model-generation">Cross Model Generation?</h2>
<p>In the world of the shadow model transformation language there are no models or modules. All elements inside the repository are part of the same big tree. Modules and models are represented as nodes of a special concept (see <em>de.q60.mps.shadowmodels.runtimelang</em>).</p>
<p>This allows to define transformations on models/modules in the same way as on nodes. There are no root mapping rules, because root nodes are just child nodes of a <em>Model</em> node.</p>
<p>Without models the problem of cross model references doesn't exist.</p>
<h2 id="multiple-target-languages-fork">Multiple Target Languages (fork)?</h2>
<p>Sometimes, you need to generate your DSL into multiple target languages. Or just multiple files from one input node (C header and implementation files).</p>
<p>In the MPS generator it's hard to control on which input a reduction rule is applied and when (since  <a href="https://www.jetbrains.com/mps/whatsnew/2018.2/">MPS 2018.2</a> it's possible to add forks to a generation plan which is supposed to solve some of the issues for this use case).</p>
<p>In shadow models, transformations are similar to function calls that accept an input node and return an output node. The engine doesn't automatically apply transformation rules. You always have control over what is applied where. A transformation rule doesn't replace the input node, but is inserted at the location of the call in the output.</p>
<h2 id="references-to-non-shadow-nodes">References to Non-Shadow Nodes</h2>
<p>If you want to generate code against an existing runtime library, you can just write a baseLanguage expression that returns an <code>SNode</code> or <code>SNodeReference</code>.
In the <em>statemachines</em> example you can find the following transformation:</p>
<pre><code>transformation enumConst overrides ... [i0: INamedConcept]
-&gt; o0: EnumConstantDeclaration {
         name: _.name
         constructor -&gt; *[node-ptr/Object-&gt;Object/]
       }
</code></pre>

<p>The constructor reference is pointing to the constructor of the Object class in the JDK stub models.</p>
<h1 id="traceback">Traceback</h1>
<p>A debug view for visualising the transformation calls is planed, but currently there is only an API to query the input nodes of a given output node. You can find it in the <code>TransformationTrace</code> class.</p></div>
        
        
    </div>

    <footer class="col-md-12 text-center">
        
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>

        
        
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script src="../../js/base.js"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
